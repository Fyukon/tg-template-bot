# **Lead Bot (–ë–æ—Ç –¥–ª—è —Å–±–æ—Ä–∞ –∑–∞—è–≤–æ–∫) üöÄ**

–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π Telegram-–±–æ—Ç –Ω–∞ –±–∞–∑–µ aiogram 3.x, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–π –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å–±–æ—Ä–∞ –∑–∞—è–≤–æ–∫ (–ª–∏–¥–æ–≤). –ë–æ—Ç —Å–æ–±–∏—Ä–∞–µ—Ç –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É —É–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–º–∏.

## **üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫**

* **–Ø–∑—ã–∫:** [Python 3.12](https://www.python.org/)  
* **–§—Ä–µ–π–º–≤–æ—Ä–∫:** [Aiogram 3.23](https://docs.aiogram.dev/)  
* **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** [PostgreSQL 15](https://www.postgresql.org/)  
* **ORM:** [SQLAlchemy 2.0](https://www.sqlalchemy.org/) (Async)  
* **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è:** [Docker](https://www.docker.com/) & [Docker Compose](https://docs.docker.com/compose/)

## **‚ú® –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**

* **–°–±–æ—Ä –∑–∞—è–≤–æ–∫:** –ü–æ—à–∞–≥–æ–≤–∞—è —Ñ–æ—Ä–º–∞ (FSM) –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–º–µ–Ω–∏, –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è.  
* **Middleware (Anti-flood):** –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞ (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã —Å–æ–æ–±—â–µ–Ω–∏–π).  
* **–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å:** –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–∏–¥–æ–≤ –∏ –æ—á–∏—Å—Ç–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫–∏. –î–æ—Å—Ç—É–ø —Å—Ç—Ä–æ–≥–æ –ø–æ ADMIN\_ID.  
* **–ê–≤—Ç–æ-–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:** –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å–∞–º–∞ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ.

## **üöÄ –ü–æ—à–∞–≥–æ–≤–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∑–∞–ø—É—Å–∫—É (–¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤)**

–ï—Å–ª–∏ –≤—ã —Ä–∞–Ω—å—à–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–∏ —Å Docker –∏–ª–∏ —Ç–µ—Ä–º–∏–Ω–∞–ª–æ–º, –ø—Ä–æ—Å—Ç–æ —Å–ª–µ–¥—É–π—Ç–µ —ç—Ç–∏–º —à–∞–≥–∞–º.

### **–®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤**

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–∞ –≤–∞—à–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ (–∏–ª–∏ —Å–µ—Ä–≤–µ—Ä–µ) —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:

1. **Git** ‚Äî –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞.  
2. **Docker Desktop** (–¥–ª—è Windows/Mac) –∏–ª–∏ **Docker Engine \+ Compose** (–¥–ª—è Linux).

### **–®–∞–≥ 2: –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–¥–∞**

–û—Ç–∫—Ä–æ–π—Ç–µ —Ç–µ—Ä–º–∏–Ω–∞–ª (–∏–ª–∏ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É) –∏ —Å–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞, –∑–∞—Ç–µ–º –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –Ω–µ—ë:

\# –ö–æ–ø–∏—Ä—É–µ–º –ø—Ä–æ–µ–∫—Ç –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è  
git clone \[https://github.com/Fyukon/tg-template-bot.git\](https://github.com/Fyukon/tg-template-bot.git)

\# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞  
cd tg-template-bot

### **–®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)**

–ë–æ—Ç –Ω–µ –∑–Ω–∞–µ—Ç –≤–∞—à–µ–≥–æ —Ç–æ–∫–µ–Ω–∞ –∏ ID, –ø–æ–∫–∞ –≤—ã –∏—Ö –Ω–µ –ø—Ä–æ–ø–∏—à–µ—Ç–µ. –í –ø–∞–ø–∫–µ app –µ—Å—Ç—å –æ–±—Ä–∞–∑–µ—Ü —Ñ–∞–π–ª–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫.

1. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª:**  
   cp app/env.example app/.env

2. **–û—Ç–∫—Ä–æ–π—Ç–µ app/.env —á–µ—Ä–µ–∑ –ª—é–±–æ–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä** (–ë–ª–æ–∫–Ω–æ—Ç, VS Code, Nano) –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ:  
   * BOT\_TOKEN: –ë–µ—Ä–µ—Ç—Å—è —É [@BotFather](https://t.me/BotFather).  
   * ADMIN\_ID: –í–∞—à —á–∏—Å–ª–æ–≤–æ–π ID (—É–∑–Ω–∞—Ç—å –º–æ–∂–Ω–æ –≤ [@userinfobot](https://t.me/userinfobot)).  
   * DATABASE\_URL: –û—Å—Ç–∞–≤—å—Ç–µ –∫–∞–∫ –µ—Å—Ç—å: postgresql+asyncpg://user:password@db:5432/tg\_bot\_db. –°–ª–æ–≤–æ db –∑–¥–µ—Å—å ‚Äî —ç—Ç–æ –∏–º—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –≤–Ω—É—Ç—Ä–∏ —Å–µ—Ç–∏ Docker.

### **–®–∞–≥ 4: –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker**

–¢–µ–ø–µ—Ä—å –º–∞–≥–∏—è. Docker —Å–∞–º —Å–∫–∞—á–∞–µ—Ç Python, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫–∏, –ø–æ–¥–Ω–∏–º–µ—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∏ —Å–≤—è–∂–µ—Ç –≤—Å—ë –≤–æ–µ–¥–∏–Ω–æ.

\# –°–æ–±–∏—Ä–∞–µ–º –∏ –∑–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–µ–∫—Ç –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ  
docker-compose up \-d \--build

**–ß—Ç–æ –æ–∑–Ω–∞—á–∞—é—Ç —ç—Ç–∏ —Ñ–ª–∞–≥–∏:**

* up: –ü–æ–¥–Ω—è—Ç—å —Å–µ—Ä–≤–∏—Å—ã.  
* \-d: (detached) –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ (—Ç–µ—Ä–º–∏–Ω–∞–ª –Ω–µ –∑–∞–∫—Ä–æ–µ—Ç—Å—è –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ –±–æ—Ç–∞).  
* \--build: –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑ (–Ω—É–∂–Ω–æ, –µ—Å–ª–∏ –≤—ã –º–µ–Ω—è–ª–∏ —á—Ç–æ-—Ç–æ –≤ –∫–æ–¥–µ).

### **–®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã**

–ß—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å—ë –∑–∞–ø—É—Å—Ç–∏–ª–æ—Å—å —É—Å–ø–µ—à–Ω–æ, –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –±–æ—Ç–∞:

docker logs \-f tg\_bot\_app

–ï—Å–ª–∏ –≤ –∫–æ–Ω—Ü–µ –Ω–∞–ø–∏—Å–∞–Ω–æ \[INFO\] \- –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω\!, –∑–Ω–∞—á–∏—Ç, –≤—Å—ë —Å–¥–µ–ª–∞–Ω–æ –≤–µ—Ä–Ω–æ. –ú–æ–∂–Ω–æ –ø–∏—Å–∞—Ç—å –±–æ—Ç—É –≤ Telegram.

## **üõ† –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∏ –∫–æ–º–∞–Ω–¥—ã**

* **–û—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–æ—Ç–∞:** docker-compose down  
* **–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫:** docker-compose restart bot  
* **–ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤:** docker ps

## **üìë –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞**

* app/main.py: –°–µ—Ä–¥—Ü–µ –±–æ—Ç–∞, –∑–∞–ø—É—Å–∫ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è.  
* app/database.py: –û–ø–∏—Å–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü User –∏ Lead.  
* app/dao.py: –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏ (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–ø–æ–ª—É—á–µ–Ω–∏–µ).  
* app/routers/: –ü–∞–ø–∫–∞ —Å –ª–æ–≥–∏–∫–æ–π –∫–æ–º–∞–Ω–¥, –∫–Ω–æ–ø–æ–∫ –∏ —Ñ–æ—Ä–º.  
* app/middleware.py: –ó–∞—â–∏—Ç–∞ –æ—Ç —á–∞—Å—Ç–æ–≥–æ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–æ–∫.

## **–î–µ–º–æ**
![user demo](assets/demo2.gif)

## **üë®‚Äçüíª –ö–æ–Ω—Ç–∞–∫—Ç—ã**

–ê–≤—Ç–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞: [@alseky](https://www.google.com/search?q=https://t.me/alseky)

